version: '3.8'

services:
  # ============================================================
  # Container 1: Activation Data
  # ============================================================
  activationbase:
    image: activationbase_app07
    container_name: activationbase_container
    volumes:
      - ./shared_data:/shared_data
    command: sh -c "cp /activationBase/currentActivation.csv /shared_data/activation_data.csv && cat /shared_data/activation_data.csv"

  # ============================================================
  # Container 2: AI Model (Knowledge Base)
  # ============================================================
  knowledgebase:
    image: knowledgebase_app07
    container_name: knowledgebase_container
    volumes:
      - ./shared_data:/shared_data
    command: sh -c "cp /knowledgeBase/currentSolution.pkl /shared_data/currentSolution.pkl && ls -lh /shared_data/"
    depends_on:
      - activationbase

  # ============================================================
  # Container 3: Code Execution
  # ============================================================
  codebase:
    image: codebase_app07
    container_name: codebase_container
    volumes:
      - ./shared_data:/shared_data
    working_dir: /shared_data
    command: python3 /codeBase/UE_07_App5.py
    depends_on:
      - activationbase
      - knowledgebase

volumes:
  shared_data: